def getTags() {
        def get = new URL("https://api.npoint.io/94c7dfacc8e334149afb").openConnection();
        def getRC = get.getResponseCode();
        print "line 4 executed"

        def slurper = new groovy.json.JsonSlurper()
        def finalResult = "AB,CD,EF"
        if(getRC.equals(200)) {
            print "received api response."
            def response = get.getInputStream().getText();
            def parsedResponse = slurper.parseText(response)
            println(parsedResponse.results);
            finalResult = parsedResponse.results
        }
        print "returning result"
        return finalResult
}

pipeline {
  agent any
  options {
    buildDiscarder(
      logRotator(daysToKeepStr: '5', numToKeepStr: '5')
    )
    disableConcurrentBuilds()
  }

parameters {
        extendedChoice(
            name: 'TagName',
            defaultValue: '',
            description: 'tag name',
            type: 'PT_SINGLE_SELECT',
            groovyScript: '''
                return getTags()
                '''
        )

}

  environment {
      def GENERATED_BUILD_TAG = ''
  }
  stages {
    stage('parameterBuild') {
      steps {
        script {
          sh 'echo demo'
        }
      }
    }
  }//job stages
}//pipeline
